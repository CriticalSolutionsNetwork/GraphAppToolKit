<!DOCTYPE html>
<!--
<auto-generated>
  <synopsis>
    This code was generated by a psDoc. on: 03/14/2025 13:54:58
    Get it here: https://github.com/ChaseFlorell/psDoc
  </synopsis>
  <description>
    If you'd like to regenerate the documentation, please open up powershell and run

        > Import-Module GraphAppToolkit
        > .\psDoc.ps1 -moduleName GraphAppToolkit

    If the documentation is incomplete, or erroneous, please edit the comments
    at the top of the module method within it's respective .ps1 file.
  </description>
</auto-generated>
-->
<html lang="en">
	<head>
		<title>GraphAppToolkit Documentation</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">

		<link href="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shCore.min.css" rel="stylesheet" charset="utf-8">
		<link href="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/styles/shCoreDefault.min.css" rel="stylesheet" charset="utf-8">
		<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet" charset="utf-8">

		<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
			<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->
		<style>
		  .syntaxhighlighter {
		      overflow-y: hidden !important;
		      overflow-x: auto !important;
		  }
		  pre {
		      min-height: 30px;
		  }
		  .navbar-nav {
		      height: 100%;
		      overflow-y: auto;
		  }
		  .form-group {
		      padding-top: 12px;
		      padding-left: 12px;
		      padding-right: 12px;
		  }
		  .sidebar-nav .navbar-header {
		      float: none;
		  }
	      .sidebar-nav .navbar li a {
	          padding-top: 4px;
	          padding-bottom: 4px;
	      }
		  @media (min-width: 768px) {
		      .sidebar-nav .navbar .navbar-collapse {
		          padding: 0;
		          max-height: none;
		      }
		      .sidebar-nav .navbar ul {
		          float: none;
		      }
		      .sidebar-nav .navbar ul:not {
		          display: block;
		      }
		      .sidebar-nav .navbar li {
		          float: none;
		          display: block;
		      }
		  }
		</style>

	</head>
	<body>
    <div class="container-fluid">
		<div class="row-fluid">
        	<div><h1>GraphAppToolkit</h1></div>
        </div>
		<div class="row-fluid">
          <div class="col-lg-3 col-md-4 col-sm-5 col-xs-12">
            <div class="sidebar-nav">
              <div class="navbar navbar-default" role="navigation">
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".sidebar-navbar-collapse">
                    <span class="sr-only">Toggle</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                  </button>
                  <span class="visible-xs navbar-brand">click menu to open</span>
                </div>
                <div class="navbar-collapse collapse sidebar-navbar-collapse">

			      <div class="form-group">
					<input class="form-control" id="searchinput" type="search" placeholder="Filter..." />
				  </div>

                  <ul class="nav navbar-nav list-group" id="searchList">
					<li class="nav-menu list-group-item"><a href="#New-MailEnabledSendingGroup">New-MailEnabledSendingGroup</a></li>
					<li class="nav-menu list-group-item"><a href="#Publish-TkEmailApp">Publish-TkEmailApp</a></li>
					<li class="nav-menu list-group-item"><a href="#Publish-TkM365AuditApp">Publish-TkM365AuditApp</a></li>
					<li class="nav-menu list-group-item"><a href="#Publish-TkMemPolicyManagerApp">Publish-TkMemPolicyManagerApp</a></li>
					<li class="nav-menu list-group-item"><a href="#Send-TkEmailAppMessage">Send-TkEmailAppMessage</a></li>
                  </ul>
                </div><!--/.nav-collapse -->
              </div>
            </div>
          </div>
          <div class="col-lg-9 col-md-8 col-sm-7 col-xs-12">
				<div id="New-MailEnabledSendingGroup" class="toggle_container">
					<div class="page-header">
						<h2> New-MailEnabledSendingGroup </h2>
                        <p><p>Creates or retrieves a mail-enabled security group with a custom or default domain.</p>
</p>
                        <p><p>The New-MailEnabledSendingGroup function ensures that a mail-enabled security group is
available for restricting email sending in Exchange Online. If a group of the specified
name already exists and is security-enabled, the function returns that group. Otherwise,
it creates a new security-enabled distribution group. You can specify either a custom
primary SMTP address (via the 'CustomDomain' parameter set) or construct one using an
alias and default domain (via the 'DefaultDomain' parameter set).
By default, the 'CustomDomain' parameter set is used. If you wish to construct the SMTP
address from the alias, switch to the 'DefaultDomain' parameter set.</p>
</p>
					</div>
                        <div>
                        <h3> Syntax </h3>
                        </div>
						<div class="panel panel-default">
                            <div class='panel-body'>
<pre class="brush: ps">New-MailEnabledSendingGroup -Name &lt;String&gt; [-Alias &lt;String&gt;] -PrimarySmtpAddress &lt;String&gt; [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]

New-MailEnabledSendingGroup -Name &lt;String&gt; [-Alias &lt;String&gt;] -DefaultDomain &lt;String&gt; [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]</pre>
                            </div>
						</div>
						<div>
							<h3> Parameters </h3>
							<table class="table table-striped table-bordered table-condensed visible-on">
								<thead>
									<tr>
										<th>Name</th>
                                        <th class="visible-lg visible-md">Alias</th>
										<th>Description</th>
										<th class="visible-lg visible-md">Required?</th>
										<th class="visible-lg">Pipeline Input</th>
										<th class="visible-lg">Default Value</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td><nobr>-Name</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>The name of the mail-enabled security group to create or retrieve. This is also used as
the alias if no separate Alias parameter is provided.</p>
</td>
										<td class="visible-lg visible-md">true</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-Alias</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>An optional alias for the group. If omitted, the group name is used as the alias.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-PrimarySmtpAddress</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>(CustomDomain parameter set) The full SMTP address for the group (e.g. &quot;MyGroup@contoso.com&quot;).
This parameter is mandatory when using the 'CustomDomain' parameter set.</p>
</td>
										<td class="visible-lg visible-md">true</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-DefaultDomain</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>(DefaultDomain parameter set) The domain portion to be appended to the group alias (e.g.
&quot;Alias@DefaultDomain&quot;). This parameter is mandatory when using the 'DefaultDomain' parameter set.</p>
</td>
										<td class="visible-lg visible-md">true</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-WhatIf</nobr></td>
                                        <td class="visible-lg visible-md">wi</td>
                                        <td></td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-Confirm</nobr></td>
                                        <td class="visible-lg visible-md">cf</td>
                                        <td></td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
								</tbody>
							</table>
						</div>
						<div>
					        <h3> Inputs </h3>
                            <p>The input type is the type of the objects that you can pipe to the cmdlet.</p>
                            <ul><li>None. This function does not accept pipeline input.</li></ul>
					    </div>
						<div>
							<h3> Outputs </h3>
                            <p>The output type is the type of the objects that the cmdlet emits.</p>
							<ul><li>Microsoft.Exchange.Data.Directory.Management.DistributionGroup
Returns the newly created or existing mail-enabled security group object.</li></ul>
						</div>
						<div class='panel panel-default'>
                            <div class='panel-heading'>
                                <h3 class='panel-title'> Note </h3>
                            </div>
							<div class='panel-body'>- Requires connectivity to Exchange Online (Connect-TkMsService -ExchangeOnline).
    - The caller must have sufficient privileges to create or modify distribution groups.
    - DefaultParameterSetName = 'CustomDomain'.</div>
						</div>
                        <div>
                            <h3> Examples </h3>
                        </div>
						<div class='panel panel-default'>
                            <div class='panel-body'>
							    <strong>EXAMPLE 1</strong>
                                <pre class="brush: ps">New-MailEnabledSendingGroup -Name "SecureSenders" -DefaultDomain "contoso.com"
Creates a new mail-enabled security group named "SecureSenders" with a primary SMTP address
of SecureSenders@contoso.com.</pre>
                                <div></div>
							    <strong>EXAMPLE 2</strong>
                                <pre class="brush: ps">New-MailEnabledSendingGroup -Name "SecureSenders" -Alias "Senders" -PrimarySmtpAddress "Senders@customdomain.org"
Creates a new mail-enabled security group named "SecureSenders" with an alias "Senders"
and a primary SMTP address of Senders@customdomain.org.</pre>
                                <div></div>
                            </div>
						</div>
                        <p class='pull-right'><a onclick='document.body.scrollTop = document.documentElement.scrollTop = 0;' style='cursor: pointer;'>Top of page</a>
				</div>
				<div id="Publish-TkEmailApp" class="toggle_container">
					<div class="page-header">
						<h2> Publish-TkEmailApp </h2>
                        <p><p>Publishes a new or existing Graph Email App with specified configurations.</p>
</p>
                        <p><p>The Publish-TkEmailApp function creates or configures a Graph Email App in Azure AD. It supports two scenarios:</p>
<ol>
<li>Creating a new app with specified parameters.</li>
<li>Using an existing app and attaching a certificate to it.</li>
</ol>
</p>
					</div>
                        <div>
                        <h3> Syntax </h3>
                        </div>
						<div class="panel panel-default">
                            <div class='panel-body'>
<pre class="brush: ps">Publish-TkEmailApp [-AppPrefix &lt;String&gt;] -AuthorizedSenderUserName &lt;String&gt; -MailEnabledSendingGroup &lt;String&gt; [-CertPrefix &lt;String&gt;] [-CertThumbprint &lt;String&gt;] [-KeyExportPolicy &lt;String&gt;] [-VaultName &lt;String&gt;] [-OverwriteVaultSecret] [-ReturnParamSplat] [-DoNotUseDomainSuffix] [&lt;CommonParameters&gt;]

Publish-TkEmailApp -ExistingAppObjectId &lt;String&gt; -CertPrefix &lt;String&gt; [-CertThumbprint &lt;String&gt;] [-KeyExportPolicy &lt;String&gt;] [-VaultName &lt;String&gt;] [-OverwriteVaultSecret] [-ReturnParamSplat] [-DoNotUseDomainSuffix] [&lt;CommonParameters&gt;]</pre>
                            </div>
						</div>
						<div>
							<h3> Parameters </h3>
							<table class="table table-striped table-bordered table-condensed visible-on">
								<thead>
									<tr>
										<th>Name</th>
                                        <th class="visible-lg visible-md">Alias</th>
										<th>Description</th>
										<th class="visible-lg visible-md">Required?</th>
										<th class="visible-lg">Pipeline Input</th>
										<th class="visible-lg">Default Value</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td><nobr>-AppPrefix</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>The prefix used to initialize the Graph Email App. Must be 2-4 characters, letters, and numbers only. Default is 'Gtk'.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">Gtk</td>
									</tr>
									<tr>
										<td><nobr>-AuthorizedSenderUserName</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>The username of the authorized sender. Must be a valid email address.</p>
</td>
										<td class="visible-lg visible-md">true</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-MailEnabledSendingGroup</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>The mail-enabled security group. Must be a valid email address.</p>
</td>
										<td class="visible-lg visible-md">true</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-ExistingAppObjectId</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>The AppId of the existing App Registration to which you want to attach a certificate. Must be a valid GUID.</p>
</td>
										<td class="visible-lg visible-md">true</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-CertPrefix</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>Prefix to add to the certificate subject for the existing app.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-CertThumbprint</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>The thumbprint of the certificate to be retrieved. Must be a valid 40-character hexadecimal string.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-KeyExportPolicy</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>Key export policy for the certificate. Valid values are 'Exportable' and 'NonExportable'. Default is 'NonExportable'.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">NonExportable</td>
									</tr>
									<tr>
										<td><nobr>-VaultName</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>If specified, use a custom vault name. Otherwise, use the default 'GraphEmailAppLocalStore'.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">GraphEmailAppLocalStore</td>
									</tr>
									<tr>
										<td><nobr>-OverwriteVaultSecret</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>If specified, overwrite the vault secret if it already exists.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">False</td>
									</tr>
									<tr>
										<td><nobr>-ReturnParamSplat</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>If specified, return the parameter splat for use in other functions.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">False</td>
									</tr>
									<tr>
										<td><nobr>-DoNotUseDomainSuffix</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>Switch to add session domain suffix to the app name.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">False</td>
									</tr>
								</tbody>
							</table>
						</div>
						<div class='panel panel-default'>
                            <div class='panel-heading'>
                                <h3 class='panel-title'> Note </h3>
                            </div>
							<div class='panel-body'>This cmdlet requires that the user running the cmdlet have the necessary permissions to create the app and connect to Exchange Online.</div>
						</div>
                        <div>
                            <h3> Examples </h3>
                        </div>
						<div class='panel panel-default'>
                            <div class='panel-body'>
							    <strong>EXAMPLE 1</strong>
                                <pre class="brush: ps"># Permissions required for app registration:
    - 'Application.ReadWrite.All'
    - 'DelegatedPermissionGrant.ReadWrite.All'
    - 'Directory.ReadWrite.All'
    - 'RoleManagement.ReadWrite.Directory'
# Permissions granted to the app:
    - 'Mail.Send' (Application) - Send mail as any user
    Exchange application policy restricts send to a mail enabled security group
# Ensure a mail enabled sending group is created first:
    $DefaultDomain = 'contoso.com'
    $MailEnabledSendingGroupToCreate = "CTSO-GraphAPIMail"
# Creates a mail-enabled security group named "MySenders" using a default domain
    $group = New-MailEnabledSendingGroup -Name $MailEnabledSendingGroupToCreate -DefaultDomain $DefaultDomain
# Create a new Graph Email App for a single tenant
    $LicensedUserToSendAs = 'helpdesk@contoso.com'
    Publish-TkEmailApp `
        -AuthorizedSenderUserName $LicensedUserToSendAs `
        -MailEnabledSendingGroup $group.PrimarySmtpAddress `
        -ReturnParamSplat
# Returns an app named like 'GraphToolKit-Gtk-&lt;Session AD Domain&gt;-As-helpdesk'
# Returns a param splat that can be used as input for the send mail function:
# Example:
    $params = @{
        AppId                  = 'your-app-id'
        Id                     = 'your-app-object-id'
        AppName                = 'GraphToolKit-Gtk-&lt;Session AD Domain&gt;-As-helpdesk'
        CertificateSubject     = 'GraphToolKit-GTK-&lt;Session AD Domain&gt;-As-helpdesk'
        AppRestrictedSendGroup = 'CTSO-GraphAPIMail@contoso.com'
        CertExpires            = 'yyyy-MM-dd HH:mm:ss'
        CertThumbprint         = 'your-cert-thumbprint'
        ConsentUrl             = 'https://login.microsoftonline.com/&lt;your-tenant-id&gt;/adminconsent?client_id=&lt;your-app-id&gt;'
        DefaultDomain          = 'contoso.com'
        SendAsUser             = 'helpdesk'
        SendAsUserEmail        = 'helpdesk@contoso.com'
        TenantID               = 'your-tenant-id'
    }</pre>
                                <div></div>
							    <strong>EXAMPLE 2</strong>
                                <pre class="brush: ps"># Create a multi client app registration where one app exists and multiple certificates are associated to the app:
# Initial setup:
# Create the group as before (or reuse the existing group) and run the following commands:
    $LicensedUserToSendAs = 'helpdesk@contoso.com'
    $CertPrefix = "CTSO" # First Company prefix. This will be used to prefix the certificate subject.
    Publish-TkEmailApp `
        -CertPrefix $CertPrefix `
        -AuthorizedSenderUserName $LicensedUserToSendAs `
        -MailEnabledSendingGroup $group.PrimarySmtpAddress `
        -ReturnParamSplat
# Returns an app named like 'GraphToolKit-Gtk-&lt;Session AD Domain&gt;-As-helpdesk'
    $params = @{
        AppId                  = 'your-app-id'
        Id                     = 'your-app-object-id'
        AppName                = 'GraphToolKit-Gtk-&lt;Session AD Domain&gt;-As-helpdesk'
        CertificateSubject     = 'GraphToolKit-CTSO-&lt;Session AD Domain&gt;-As-helpdesk'
        AppRestrictedSendGroup = 'CTSO-GraphAPIMail@contoso.com'
        CertExpires            = 'yyyy-MM-dd HH:mm:ss'
        CertThumbprint         = 'your-cert-thumbprint'
        ConsentUrl             = 'https://login.microsoftonline.com/&lt;your-tenant-id&gt;/adminconsent?client_id=&lt;your-app-id&gt;'
        DefaultDomain          = 'contoso.com'
        SendAsUser             = 'helpdesk'
        SendAsUserEmail        = 'helpdesk@contoso.com'
        TenantID               = 'your-tenant-id'
    }
    $useExistingParams = @{
        ExistingAppObjectId  = $params.Id
        CertPrefix           = 'NewCompany'
        OverwriteVaultSecret = $true      # optional, if you want to overwrite the existing vault secret
        ReturnParamSplat     = $true      # optional, returns the param splat
    }
    Publish-TkEmailApp @useExistingParams
# The new Cert will be prefixed with the new company prefix and will allow the current client to authenticate.
# Back in the app registrations console, if you look at the internal notes in the properties of the app:
# The app's "Internal Notes" will be populated with the following json:
# Assists in tracking the app's usage and configuration.
    {
        "GraphEmailAppFor": "helpdesk@contoso.com",
        "RestrictedToGroup": "CTSO-GraphAPIMail@contoso.com",
        "AppPermissions": "Mail.Send",
        "New-Company_ClientIP": "&lt;Public IP Address of the client where the app was called&gt;",
        "New-Company_Host": "&lt;Host of the client where the app was called&gt;",
        "NewCoolCompany_ClientIP": "&lt;Public IP Address of the client where the app was called&gt;",
        "NewCoolCompany_Host": "Host of the client where the app was called&gt;"
    }
    # New cert additions added through the toolkit will append new client info to these notes.</pre>
                                <div></div>
                            </div>
						</div>
                        <p class='pull-right'><a onclick='document.body.scrollTop = document.documentElement.scrollTop = 0;' style='cursor: pointer;'>Top of page</a>
				</div>
				<div id="Publish-TkM365AuditApp" class="toggle_container">
					<div class="page-header">
						<h2> Publish-TkM365AuditApp </h2>
                        <p><p>Publishes (creates) a new M365 Audit App registration in Entra ID (Azure AD) with a specified certificate.</p>
</p>
                        <p><p>The Publish-TkM365AuditApp function creates a new Azure AD application used for M365 auditing.
It connects to Microsoft Graph, gathers the required permissions for SharePoint and Exchange,
and optionally creates a self-signed certificate if no thumbprint is provided. It also assigns
the application to the Exchange Administrator and Global Reader roles. By default, the newly
created application details are stored as a secret in the specified SecretManagement vault.</p>
</p>
					</div>
                        <div>
                        <h3> Syntax </h3>
                        </div>
						<div class="panel panel-default">
                            <div class='panel-body'>
<pre class="brush: ps">Publish-TkM365AuditApp [[-AppPrefix] &lt;String&gt;] [[-CertThumbprint] &lt;String&gt;] [[-KeyExportPolicy] &lt;String&gt;] [[-VaultName] &lt;String&gt;] [-OverwriteVaultSecret] [-ReturnParamSplat] [-DoNotUseDomainSuffix] [&lt;CommonParameters&gt;]</pre>
                            </div>
						</div>
						<div>
							<h3> Parameters </h3>
							<table class="table table-striped table-bordered table-condensed visible-on">
								<thead>
									<tr>
										<th>Name</th>
                                        <th class="visible-lg visible-md">Alias</th>
										<th>Description</th>
										<th class="visible-lg visible-md">Required?</th>
										<th class="visible-lg">Pipeline Input</th>
										<th class="visible-lg">Default Value</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td><nobr>-AppPrefix</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>A short prefix (2-4 alphanumeric characters) used to build the app name. Defaults to &quot;Gtk&quot;
if not specified. Example app name: GraphToolKit-MSN-GraphApp-MyDomain-As-helpDesk</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">Gtk</td>
									</tr>
									<tr>
										<td><nobr>-CertThumbprint</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>The thumbprint of an existing certificate in the current user's certificate store. If not
provided, a new self-signed certificate is created.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-KeyExportPolicy</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>Specifies whether the newly created certificate (if no thumbprint is provided) is
'Exportable' or 'NonExportable'. Defaults to 'NonExportable'.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">NonExportable</td>
									</tr>
									<tr>
										<td><nobr>-VaultName</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>The SecretManagement vault name in which to store the app credentials. Defaults to
&quot;M365AuditAppLocalStore&quot; if not specified.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">M365AuditAppLocalStore</td>
									</tr>
									<tr>
										<td><nobr>-OverwriteVaultSecret</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>If specified, overwrites an existing secret in the specified vault if it already exists.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">False</td>
									</tr>
									<tr>
										<td><nobr>-ReturnParamSplat</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>If specified, returns a parameter splat string for use in other functions, instead of the
default PSCustomObject containing the app details.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">False</td>
									</tr>
									<tr>
										<td><nobr>-DoNotUseDomainSuffix</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>If specified, does not append the domain suffix to the app name.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">False</td>
									</tr>
								</tbody>
							</table>
						</div>
						<div>
					        <h3> Inputs </h3>
                            <p>The input type is the type of the objects that you can pipe to the cmdlet.</p>
                            <ul><li>None. This function does not accept pipeline input.</li></ul>
					    </div>
						<div>
							<h3> Outputs </h3>
                            <p>The output type is the type of the objects that the cmdlet emits.</p>
							<ul><li>By default, returns a PSCustomObject with details of the new app (AppId, ObjectId, TenantId,
certificate thumbprint, expiration, etc.). If -ReturnParamSplat is used, returns a parameter
splat string.</li></ul>
						</div>
						<div class='panel panel-default'>
                            <div class='panel-heading'>
                                <h3 class='panel-title'> Note </h3>
                            </div>
							<div class='panel-body'>Requires the Microsoft.Graph and ExchangeOnlineManagement modules for app creation and
    role assignment. The user must have sufficient privileges to create and manage applications
    in Azure AD, and to assign roles. After creation, admin consent may be required for the
    assigned permissions.
    Permissions required for app registration:
        'Application.ReadWrite.All',
        'DelegatedPermissionGrant.ReadWrite.All',
        'Directory.ReadWrite.All',
        'RoleManagement.ReadWrite.Directory'
    
    Permissions granted to the app:
    (Exchange Administrator and Global Reader Roles are also added to the service principal.)
        'AppCatalog.ReadWrite.All',
        'Channel.Delete.All',
        'ChannelMember.ReadWrite.All',
        'ChannelSettings.ReadWrite.All',
        'Directory.Read.All',
        'Group.ReadWrite.All',
        'Organization.Read.All',
        'Policy.Read.All',
        'Domain.Read.All',
        'TeamSettings.ReadWrite.All',
        'User.Read.All',
        'Sites.Read.All',
        'Sites.FullControl.All',
        'Exchange.ManageAsApp'</div>
						</div>
                        <div>
                            <h3> Examples </h3>
                        </div>
						<div class='panel panel-default'>
                            <div class='panel-body'>
							    <strong>EXAMPLE 1</strong>
                                <pre class="brush: ps">Publish-TkM365AuditApp -AppPrefix "CS12" -ReturnParamSplat
Creates a new M365 Audit App with the prefix "CS12", returns a parameter splat, and stores
the credentials in the default vault.</pre>
                                <div></div>
                            </div>
						</div>
                        <p class='pull-right'><a onclick='document.body.scrollTop = document.documentElement.scrollTop = 0;' style='cursor: pointer;'>Top of page</a>
				</div>
				<div id="Publish-TkMemPolicyManagerApp" class="toggle_container">
					<div class="page-header">
						<h2> Publish-TkMemPolicyManagerApp </h2>
                        <p><p>Publishes a new MEM (Intune) Policy Manager App in Azure AD with read-only or read-write permissions.</p>
</p>
                        <p><p>The Publish-TkMemPolicyManagerApp function creates an Azure AD application intended for managing
Microsoft Endpoint Manager (MEM/Intune) policies. It optionally creates or retrieves a certificate,
configures the necessary Microsoft Graph permissions for read-only or read-write access, and stores
the resulting app credentials in a SecretManagement vault.</p>
</p>
					</div>
                        <div>
                        <h3> Syntax </h3>
                        </div>
						<div class="panel panel-default">
                            <div class='panel-body'>
<pre class="brush: ps">Publish-TkMemPolicyManagerApp [-AppPrefix] &lt;String&gt; [[-CertThumbprint] &lt;String&gt;] [[-KeyExportPolicy] &lt;String&gt;] [[-VaultName] &lt;String&gt;] [-OverwriteVaultSecret] [-ReadWrite] [-ReturnParamSplat] [-DoNotUseDomainSuffix] [&lt;CommonParameters&gt;]</pre>
                            </div>
						</div>
						<div>
							<h3> Parameters </h3>
							<table class="table table-striped table-bordered table-condensed visible-on">
								<thead>
									<tr>
										<th>Name</th>
                                        <th class="visible-lg visible-md">Alias</th>
										<th>Description</th>
										<th class="visible-lg visible-md">Required?</th>
										<th class="visible-lg">Pipeline Input</th>
										<th class="visible-lg">Default Value</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td><nobr>-AppPrefix</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>A 2-4 character prefix used to build the application name (e.g., CORP, MSN). This helps uniquely
identify the app in Azure AD.</p>
</td>
										<td class="visible-lg visible-md">true</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-CertThumbprint</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>The thumbprint of an existing certificate in the current user's certificate store. If omitted,
a new self-signed certificate is created.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-KeyExportPolicy</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>Specifies whether the newly created certificate is 'Exportable' or 'NonExportable'.
Defaults to 'NonExportable' if not specified.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">NonExportable</td>
									</tr>
									<tr>
										<td><nobr>-VaultName</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>The name of the SecretManagement vault in which to store the app credentials.
Defaults to 'MemPolicyManagerLocalStore'.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">MemPolicyManagerLocalStore</td>
									</tr>
									<tr>
										<td><nobr>-OverwriteVaultSecret</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>If specified, overwrites any existing secret of the same name in the vault.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">False</td>
									</tr>
									<tr>
										<td><nobr>-ReadWrite</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>If specified, grants read-write MEM/Intune permissions. Otherwise, read-only permissions are granted.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">False</td>
									</tr>
									<tr>
										<td><nobr>-ReturnParamSplat</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>If specified, returns a parameter splat string for use in other functions. Otherwise, returns
a PSCustomObject containing the app details.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">False</td>
									</tr>
									<tr>
										<td><nobr>-DoNotUseDomainSuffix</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>If specified, the function does not append the domain suffix to the app name.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">False</td>
									</tr>
								</tbody>
							</table>
						</div>
						<div>
					        <h3> Inputs </h3>
                            <p>The input type is the type of the objects that you can pipe to the cmdlet.</p>
                            <ul><li>None. This function does not accept pipeline input.</li></ul>
					    </div>
						<div>
							<h3> Outputs </h3>
                            <p>The output type is the type of the objects that the cmdlet emits.</p>
							<ul><li>By default, returns a PSCustomObject (TkMemPolicyManagerAppParams) with details of the newly created
app (AppId, certificate thumbprint, tenant ID, etc.). If -ReturnParamSplat is used, returns a parameter
splat string.</li></ul>
						</div>
						<div class='panel panel-default'>
                            <div class='panel-heading'>
                                <h3 class='panel-title'> Note </h3>
                            </div>
							<div class='panel-body'>This function requires the Microsoft.Graph module for application creation and the user must have
    permissions in Azure AD to register and grant permissions to the application. After creation, admin
    consent may be needed to finalize the permission grants.
    Permissions required for app registration::
        'Application.ReadWrite.All',
        'DelegatedPermissionGrant.ReadWrite.All',
        'Directory.ReadWrite.All'
    
    Permissions required for read-only access:
    
        'DeviceManagementConfiguration.Read.All',
        'DeviceManagementApps.Read.All',
        'DeviceManagementManagedDevices.Read.All',
        'Policy.Read.ConditionalAccess',
        'Policy.Read.All'
    
    Permissions required for read-write access:
        'DeviceManagementConfiguration.ReadWrite.All',
        'DeviceManagementApps.ReadWrite.All',
        'DeviceManagementManagedDevices.ReadWrite.All',
        'Policy.ReadWrite.ConditionalAccess',
        'Policy.Read.All'</div>
						</div>
                        <div>
                            <h3> Examples </h3>
                        </div>
						<div class='panel panel-default'>
                            <div class='panel-body'>
							    <strong>EXAMPLE 1</strong>
                                <pre class="brush: ps">Publish-TkMemPolicyManagerApp -AppPrefix "CORP" -ReadWrite
Creates a new MEM Policy Manager App with read-write permissions, retrieves or
creates a certificate, and stores the credentials in the default vault.</pre>
                                <div></div>
                            </div>
						</div>
                        <p class='pull-right'><a onclick='document.body.scrollTop = document.documentElement.scrollTop = 0;' style='cursor: pointer;'>Top of page</a>
				</div>
				<div id="Send-TkEmailAppMessage" class="toggle_container">
					<div class="page-header">
						<h2> Send-TkEmailAppMessage </h2>
                        <p><p>Sends an email using the Microsoft Graph API, either by retrieving app credentials from a local vault
or by specifying them manually.</p>
</p>
                        <p><p>The Send-TkEmailAppMessage function uses the Microsoft Graph API to send an email to a specified
recipient. It supports two parameter sets:</p>
<ol>
<li>'Vault' (default): Provide an existing app name (AppName) whose credentials are stored in the
local secret vault (e.g., GraphEmailAppLocalStore). The function retrieves the AppId, TenantId,
and certificate thumbprint automatically.</li>
<li>'Manual': Provide the AppId, TenantId, and certificate thumbprint yourself, bypassing the vault.
In both cases, the function obtains an OAuth2 token (via MSAL.PS) using the specified certificate
and uses the Microsoft Graph 'sendMail' endpoint to deliver the message.</li>
</ol>
</p>
					</div>
                        <div>
                        <h3> Syntax </h3>
                        </div>
						<div class="panel panel-default">
                            <div class='panel-body'>
<pre class="brush: ps">Send-TkEmailAppMessage -AppName &lt;String&gt; -To &lt;String&gt; -FromAddress &lt;String&gt; -Subject &lt;String&gt; -EmailBody &lt;String&gt; [-AttachmentPath &lt;String[]&gt;] [-VaultName &lt;String&gt;] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]

Send-TkEmailAppMessage -AppId &lt;String&gt; -TenantId &lt;String&gt; -CertThumbprint &lt;String&gt; -To &lt;String&gt; -FromAddress &lt;String&gt; -Subject &lt;String&gt; -EmailBody &lt;String&gt; [-AttachmentPath &lt;String[]&gt;] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]</pre>
                            </div>
						</div>
						<div>
							<h3> Parameters </h3>
							<table class="table table-striped table-bordered table-condensed visible-on">
								<thead>
									<tr>
										<th>Name</th>
                                        <th class="visible-lg visible-md">Alias</th>
										<th>Description</th>
										<th class="visible-lg visible-md">Required?</th>
										<th class="visible-lg">Pipeline Input</th>
										<th class="visible-lg">Default Value</th>
									</tr>
								</thead>
								<tbody>
									<tr>
										<td><nobr>-AppName</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>[Vault Parameter Set Only]
The name of the pre-created Microsoft Graph Email App (stored in GraphEmailAppLocalStore). Used only
if the 'Vault' parameter set is chosen. The function retrieves the AppId, TenantId, and certificate
thumbprint from the vault entry.</p>
</td>
										<td class="visible-lg visible-md">true</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-AppId</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>[Manual Parameter Set Only]
The Azure AD application (client) ID to use for sending the email. Must be used together with TenantId
and CertThumbprint in the 'Manual' parameter set.</p>
</td>
										<td class="visible-lg visible-md">true</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-TenantId</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>[Manual Parameter Set Only]
The Azure AD tenant ID (GUID or domain name). Must be used together with AppId and CertThumbprint
in the 'Manual' parameter set.</p>
</td>
										<td class="visible-lg visible-md">true</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-CertThumbprint</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>[Manual Parameter Set Only]
The certificate thumbprint (in Cert:\CurrentUser\My) used for authenticating as the Azure AD app.
Must be used together with AppId and TenantId in the 'Manual' parameter set.</p>
</td>
										<td class="visible-lg visible-md">true</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-To</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>The email address of the recipient.</p>
</td>
										<td class="visible-lg visible-md">true</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-FromAddress</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>The email address of the sender who is authorized to send email as configured in the Graph Email App.</p>
</td>
										<td class="visible-lg visible-md">true</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-Subject</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>The subject line of the email.</p>
</td>
										<td class="visible-lg visible-md">true</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-EmailBody</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>The body text of the email.</p>
</td>
										<td class="visible-lg visible-md">true</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-AttachmentPath</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>An array of file paths for any attachments to include in the email. Each path must exist as a leaf file.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-VaultName</nobr></td>
                                        <td class="visible-lg visible-md"></td>
                                        <td><p>[Vault Parameter Set Only]
The name of the vault to retrieve the GraphEmailApp object. Default is 'GraphEmailAppLocalStore'.</p>
</td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg">GraphEmailAppLocalStore</td>
									</tr>
									<tr>
										<td><nobr>-WhatIf</nobr></td>
                                        <td class="visible-lg visible-md">wi</td>
                                        <td></td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
									<tr>
										<td><nobr>-Confirm</nobr></td>
                                        <td class="visible-lg visible-md">cf</td>
                                        <td></td>
										<td class="visible-lg visible-md">false</td>
										<td class="visible-lg">false</td>
										<td class="visible-lg"></td>
									</tr>
								</tbody>
							</table>
						</div>
						<div class='panel panel-default'>
                            <div class='panel-heading'>
                                <h3 class='panel-title'> Note </h3>
                            </div>
							<div class='panel-body'>- This function requires the Microsoft.Graph, SecretManagement, SecretManagement.JustinGrote.CredMan,
        and MSAL.PS modules to be installed (handled automatically via Initialize-TkModuleEnv).
    - For the 'Vault' parameter set, the local vault secret must store JSON properties including AppId,
        TenantID, and CertThumbprint.
    - Refer to https://learn.microsoft.com/en-us/graph/outlook-send-mail for details on sending mail
        via Microsoft Graph.</div>
						</div>
                        <div>
                            <h3> Examples </h3>
                        </div>
						<div class='panel panel-default'>
                            <div class='panel-body'>
							    <strong>EXAMPLE 1</strong>
                                <pre class="brush: ps"># Using the 'Vault' parameter set
Send-TkEmailAppMessage -AppName "GraphEmailApp" -To "recipient@example.com" -FromAddress "sender@example.com" `
    -Subject "Test Email" -EmailBody "This is a test email."
Retrieves the app's credentials (AppId, TenantId, CertThumbprint) from the local vault under the
secret name "GraphEmailApp" and sends an email.</pre>
                                <div></div>
							    <strong>EXAMPLE 2</strong>
                                <pre class="brush: ps"># Using the 'Manual' parameter set
Send-TkEmailAppMessage -AppId "00000000-1111-2222-3333-444444444444" -TenantId "contoso.onmicrosoft.com" `
    -CertThumbprint "AABBCCDDEEFF11223344556677889900" -To "recipient@example.com" -FromAddress "sender@example.com" `
    -Subject "Manual Email" -EmailBody "Hello from Manual!"
Uses the provided AppId, TenantId, and CertThumbprint directly (no vault) to obtain a token and send an email.</pre>
                                <div></div>
                            </div>
						</div>
                        <p class='pull-right'><a onclick='document.body.scrollTop = document.documentElement.scrollTop = 0;' style='cursor: pointer;'>Top of page</a>
				</div>
		</div>
	</div>
	</div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js" ></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.4/js/bootstrap.min.js" charset="utf-8"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shCore.min.js" charset="utf-8"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/SyntaxHighlighter/3.0.83/scripts/shBrushPowerShell.min.js" charset="utf-8"></script>
	<script>
		$(document).ready(function() {
			$(".toggle_container").hide();
			var previousId;
		    if(location.hash) {
		        var id = location.hash.slice(1);    //Get rid of the # mark
		        var elementToShow = $("#" + id);    //Save local reference
		        if(elementToShow.length) {                   //Check if the element exists
		            elementToShow.slideToggle('fast');       //Show the element
		            elementToShow.addClass("check_list_selected");    //Add class to element (the link)
		        }
		        previousId = id;
		    }

			$('.nav-menu a, .psLink a').click(function() {
                $(".sidebar-navbar-collapse").collapse('hide');
				$('.toggle_container').hide();                 // Hide all
				var elem = $(this).prop("hash");
				$(elem).toggle('fast');   						// Show HREF/to/ID one
				history.pushState({}, '', $(this).attr("href"));
				window.scrollTo(0, 0);
				return false;
			});
			SyntaxHighlighter.defaults['toolbar'] = false;
			SyntaxHighlighter.defaults['gutter'] = false;
			SyntaxHighlighter.all();

			$('#searchList').btsListFilter('#searchinput', {itemChild: 'a', initial: false, resetOnBlur: true});

            $(document).keyup(function( e ) {
                if(!$('#searchinput').is(':focus') && e.which >= 65 && e.which <= 90 ){
                   $('#searchinput').val(String.fromCharCode(e.keyCode));
                   $('#searchinput').focus();
                }
            });
            $(document).click(function() {
                $('#searchinput').blur();
            });
		});
	</script>
    <!-- bootstrap-list-filter.min.js - removed as external resource and added as content -->
    <script>
    /*
     * bootstrap-list-filter v0.1.7 - 2015-03-30
     *
     * Copyright 2015 Stefano Cudini
     * stefano.cudini@gmail.com
     * http://labs.easyblog.it/
     *
     * Licensed under the MIT license.
     *
     * Demos:
     * http://labs.easyblog.it/bootstrap-list-filter/
     *
     * Source:
     * git@github.com:stefanocudini/bootstrap-list-filter.git
     *
     */
    !function(a){a.fn.btsListFilter=function(b,c){function d(a,b){return a.replace(/\{ *([\w_]+) *\}/g,function(a,c){return b[c]||""})}function e(a,b){var c;return b=b||300,function(){var d=this,e=arguments;clearTimeout(c),c=setTimeout(function(){a.apply(d,Array.prototype.slice.call(e))},b)}}var f,g=this,h=a(this),i=a(b),j=h;return c=a.extend({delay:300,minLength:1,initial:!0,eventKey:"keyup",resetOnBlur:!0,sourceData:null,sourceTmpl:'<a class="list-group-item" href="#"><span>{title}</span></a>',sourceNode:function(a){return d(c.sourceTmpl,a)},emptyNode:function(){return'<a class="list-group-item well" href="#"><span>No Results</span></a>'},itemEl:".list-group-item",itemChild:null,itemFilter:function(b,d){d=d&&d.replace(new RegExp("[({[^.$*+?\\]})]","g"),"");var e=a(b).text(),f=c.initial?"^":"",g=new RegExp(f+d,"i");return g.test(e)}},c),i.on(c.eventKey,e(function(){var b=a(this).val();c.itemEl&&(j=h.find(c.itemEl)),c.itemChild&&(j=j.find(c.itemChild));var d=j.filter(function(){return c.itemFilter.call(g,this,b)}),e=j.not(d);c.itemChild&&(d=d.parents(c.itemEl),e=e.parents(c.itemEl).hide()),""!==b&&b.length>=c.minLength?(d.show(),e.hide(),"function"===a.type(c.sourceData)?(d.hide(),e.hide(),f&&(a.isFunction(f.abort)?f.abort():a.isFunction(f.stop)&&f.stop()),f=c.sourceData.call(g,b,function(b){if(f=null,d.hide(),e.hide(),h.find(".bts-dynamic-item").remove(),b&&0!==b.length)for(var i in b)a(c.sourceNode.call(g,b[i])).addClass("bts-dynamic-item").appendTo(h);else a(c.emptyNode.call(g)).addClass("bts-dynamic-item").appendTo(h)})):0===d.length&&a(c.emptyNode.call(g)).addClass("bts-dynamic-item").appendTo(h)):(d.show(),e.show(),h.find(".bts-dynamic-item").remove())},c.delay)),c.resetOnBlur&&i.on("blur",function(){a(this).val("").trigger(c.eventKey)}),h}}(jQuery);
</script>
	</body>
</html>
